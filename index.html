<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Video & Ảnh từ API</title>
  <style>
    body { font-family:system-ui,Arial; background:#111; color:#fff; text-align:center; padding:18px }
    video, img { width:90%; max-width:500px; border-radius:12px; margin:10px auto; display:block; }
    h1{margin:6px 0 12px}
    button{padding:8px 14px;border-radius:8px;border:none;background:#0af;color:#000;cursor:pointer}
  </style>
</head>
<body>
  <h1>🎬 Video & 📸 Ảnh Auto</h1>
  <video id="video" controls autoplay muted loop></video>
  <button id="reloadVideo">Đổi video</button>
  <img id="image" alt="Ảnh API">

  <script>
    // ----- THAY CHỖ NÀY: đổi thành Worker URL của bạn -----
    const proxy = "https://crimson-forest-1f5f.hatient444.workers.dev";
    const videoPath = "/api/videos/gai";         // worker đã map đến api.zeidteam.xyz/videos/gai
    const imagePath = "/api/images/gaisexy";     // worker đã map đến api.zeidteam.xyz/images/gaisexy

    const videoEl = document.getElementById('video');
    const imgEl = document.getElementById('image');
    const btn = document.getElementById('reloadVideo');

    async function fetchJson(url) {
      const res = await fetch(url);
      // nếu trả nguyên file binary (video stream) thì .json() sẽ fail;
      // ở đây endpoints trả JSON nên safe to use .json()
      return res.json();
    }

    async function loadVideo() {
      try {
        const data = await fetchJson(proxy + videoPath);
        // API gốc trả: {status: true, data: "https://files...mp4", ...}
        if (data && data.status && data.data) {
          videoEl.src = data.data;
          videoEl.play().catch(()=>{ /* autoplay có thể bị chặn trên mobile */ });
        } else {
          console.error('Video API trả khác cấu trúc:', data);
        }
      } catch (e) {
        console.error('Lỗi loadVideo:', e);
      }
    }

    async function loadImage() {
      try {
        const data = await fetchJson(proxy + imagePath);
        if (data && data.status && data.data) {
          // hiệu ứng mượt
          imgEl.style.opacity = 0;
          setTimeout(()=> {
            imgEl.src = data.data;
            imgEl.style.opacity = 1;
          }, 300);
        } else {
          console.error('Image API trả khác cấu trúc:', data);
        }
      } catch (e) {
        console.error('Lỗi loadImage:', e);
      }
    }

    btn.onclick = loadVideo;
    loadVideo();
    loadImage();
    setInterval(loadImage, 5000); // đổi ảnh 5s
  </script>
</body>
</html>
